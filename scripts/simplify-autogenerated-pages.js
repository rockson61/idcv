#!/usr/bin/env node

const fs = require('fs');
const path = require('path');

console.log('🔧 Simplifying autogenerated Chennai & Kanchipuram pages...\n');
console.log('   Removing problematic components, keeping core functionality\n');

const simplifyPage = (filePath) => {
  try {
    let content = fs.readFileSync(filePath, 'utf8');
    const original = content;
    
    // Remove all problematic components
    content = content.replace(/{\/\* Local Amenities \*\/}\s*<LocalAmenitiesMap[\s\S]*?\/>/g, '');
    content = content.replace(/{\/\* Travel Info \*\/}\s*<TravelInfoCard[\s\S]*?\/>/g, '');
    content = content.replace(/{\/\* Price Comparison \*\/}\s*<PriceComparisonTable[\s\S]*?\/>/g, '');
    content = content.replace(/{\/\* Why Choose Us \*\/}\s*<WhyChooseUs[\s\S]*?\/>/g, '');
    
    // Remove unused imports
    content = content.replace(/import \{ LocalAmenitiesMap \} from.*\n/g, '');
    content = content.replace(/import \{ TravelInfoCard \} from.*\n/g, '');
    content = content.replace(/import \{ PriceComparisonTable \} from.*\n/g, '');
    content = content.replace(/import \{ WhyChooseUs \} from.*\n/g, '');
    
    //Remove unused data definitions
    content = content.replace(/const amenities = \{[\s\S]*?\};\n\n/g, '');
    content = content.replace(/const touristPlaces = \[[\s\S]*?\];\n\n/g, '');
    content = content.replace(/const transportModes = \{[\s\S]*?\};\n\n/g, '');
    
    if (content !== original) {
      fs.writeFileSync(filePath, content);
      return true;
    }
  } catch (error) {
    console.error(`❌ Error: ${error.message}`);
  }
  return false;
};

let fixed = 0;

// Simplify Chennai
const chennaiDir = path.join(__dirname, '..', 'app', 'in', 'tamil-nadu', 'chennai');
const chennaiAreas = fs.readdirSync(chennaiDir).filter(f => {
  return fs.statSync(path.join(chennaiDir, f)).isDirectory();
});

console.log(`📂 Simplifying Chennai (${chennaiAreas.length} pages)...`);
const chennaiFixed = chennaiAreas.filter(area => {
  const filePath = path.join(chennaiDir, area, 'page.tsx');
  return fs.existsSync(filePath) && simplifyPage(filePath);
}).length;
fixed += chennaiFixed;
console.log(`  ✅ Simplified ${chennaiFixed} pages\n`);

// Simplify Kanchipuram
const kanchipuramDir = path.join(__dirname, '..', 'app', 'in', 'tamil-nadu', 'kanchipuram');
const kanchipuramAreas = fs.readdirSync(kanchipuramDir).filter(f => {
  return fs.statSync(path.join(kanchipuramDir, f)).isDirectory();
});

console.log(`📂 Simplifying Kanchipuram (${kanchipuramAreas.length} pages)...`);
const kFixed = kanchipuramAreas.filter(area => {
  const filePath = path.join(kanchipuramDir, area, 'page.tsx');
  return fs.existsSync(filePath) && simplifyPage(filePath);
}).length;
fixed += kFixed;
console.log(`  ✅ Simplified ${kFixed} pages\n`);

console.log('━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━');
console.log(`✅ Total simplified: ${fixed} pages`);
console.log('━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━');
console.log('\nPages now have:');
console.log('  ✅ Metadata & SEO');
console.log('  ✅ Google Maps');
console.log('  ✅ Service listings');
console.log('  ✅ FAQs');
console.log('  ✅ Reviews');
console.log('  ✅ CTAs');
console.log('\n  (Enhanced features can be added incrementally post-launch)');

